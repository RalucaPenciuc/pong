(this.webpackJsonppong=this.webpackJsonppong||[]).push([[0],{38:function(e,t,a){e.exports=a(59)},43:function(e,t,a){},44:function(e,t,a){},45:function(e,t,a){},53:function(e,t,a){},54:function(e,t,a){},55:function(e,t,a){},56:function(e,t,a){},59:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),c=a(23),o=a.n(c),i=(a(43),a(8)),s=a(9),l=a(12),u=a(11),m=(a(44),a(10)),d=a(5),p=(a(45),a(34)),h=a.n(p),g=a(15);function E(e){return{type:"START_GAME",payload:e}}var v=function(e){Object(l.a)(a,e);var t=Object(u.a)(a);function a(){return Object(i.a)(this,a),t.apply(this,arguments)}return Object(s.a)(a,[{key:"render",value:function(){var e=this;return r.a.createElement("div",{className:"start-page-container"},r.a.createElement("p",{className:"game-title"},"PONG"),r.a.createElement("div",{className:"play-button-view"},r.a.createElement(h.a,null),r.a.createElement(m.b,{className:"play-button",to:"/games",onClick:function(){e.props.connectPlayer()}},"Play")))}}]),a}(n.Component),f=Object(g.b)(null,(function(e){return{connectPlayer:function(){return e({type:"CONNECT_PLAYER_BEGIN",payload:void 0})}}}))(v),b=(a(53),a(54),function(e){Object(l.a)(a,e);var t=Object(u.a)(a);function a(){return Object(i.a)(this,a),t.apply(this,arguments)}return Object(s.a)(a,[{key:"handleJoinButton",value:function(){var e={clientId:this.props.clientId,gameId:this.props.game._id};this.props.joinGame(e)}},{key:"render",value:function(){return r.a.createElement("div",{className:"game-item-container"},r.a.createElement("p",{className:"game-item-component"},this.props.game.name),r.a.createElement("p",{className:"game-item-component"},this.props.game.players.length),r.a.createElement(m.b,{to:"/game/".concat(this.props.game._id),onClick:this.handleJoinButton.bind(this)},"Join"))}}]),a}(n.Component)),y=Object(g.b)((function(e){return{clientId:e.clientId}}),(function(e){return{joinGame:function(t){return e(function(e){return{type:"JOIN_GAME_BEGIN",payload:e}}(t))}}}))(b),O=function(e){Object(l.a)(a,e);var t=Object(u.a)(a);function a(){return Object(i.a)(this,a),t.apply(this,arguments)}return Object(s.a)(a,[{key:"handleCreateGameButton",value:function(){var e=window.prompt("Enter the game's name: ");if(e){var t={clientId:this.props.clientId,gameName:e};this.props.createGame(t)}}},{key:"render",value:function(){return this.props.clientId?r.a.createElement("div",{className:"games-page-container"},r.a.createElement("p",{className:"page-title"},"Available Games"),r.a.createElement("div",{className:"games-page-content"},r.a.createElement("button",{className:"create-game-button",onClick:this.handleCreateGameButton.bind(this)},"Create game"),r.a.createElement("div",{className:"games-list"},r.a.createElement("div",{className:"games-list-header"},r.a.createElement("p",{className:"games-list-header-item"},"Name"),r.a.createElement("p",{className:"games-list-header-item"},"Players"),r.a.createElement("p",{className:"games-list-header-item"})),this.props.games.map((function(e){return r.a.createElement(y,{key:e._id,game:e})}))))):r.a.createElement("div",null,r.a.createElement("div",{className:"not-found-title"},"404 Games Not Found"),r.a.createElement(m.b,{to:"/"},"Return to home page."))}}]),a}(n.Component),C=Object(g.b)((function(e){return{clientId:e.clientId,games:e.games}}),(function(e){return{createGame:function(t){return e(function(e){return{type:"CREATE_GAME_BEGIN",payload:e}}(t))}}}))(O),G=(a(55),function(e){Object(l.a)(a,e);var t=Object(u.a)(a);function a(e){var n;return Object(i.a)(this,a),(n=t.call(this,e)).canvas=void 0,n.gameContext=void 0,n.canvas=r.a.createRef(),n.gameContext=null,n}return Object(s.a)(a,[{key:"componentDidMount",value:function(){this.canvas.current?(this.gameContext=this.canvas.current.getContext("2d"),this.drawGameTable()):console.log("componentDidMount: Canvas is null.")}},{key:"componentDidUpdate",value:function(){this.drawGameTable()}},{key:"handleKeyDownEvent",value:function(e){if(this.canvas.current){var t,a={clientId:this.props.clientId,gameId:null===(t=this.props.currentGame)||void 0===t?void 0:t._id,direction:e.key};this.props.registerMove(a)}else console.log("handleKeyDownEvent: Canvas is null.")}},{key:"render",value:function(){return this.props.currentGame?r.a.createElement("div",{className:"game-table-container"},r.a.createElement("canvas",{ref:this.canvas,width:1400,height:700,className:"canvas",onKeyDown:this.handleKeyDownEvent.bind(this),tabIndex:0})):r.a.createElement(r.a.Fragment,null,r.a.createElement("div",{className:"not-found-title"},"404 Game Not Found"),r.a.createElement(m.b,{to:"/"},"Return to home page."))}},{key:"drawGameTable",value:function(){if(this.canvas.current){var e,t,a,n,r,c=(null===(e=this.props.currentGame)||void 0===e?void 0:e.players[0]._id)===this.props.clientId?this.props.currentGame.players[0]:null===(t=this.props.currentGame)||void 0===t?void 0:t.players[1],o=(null===(a=this.props.currentGame)||void 0===a?void 0:a.players[0]._id)!==this.props.clientId?null===(n=this.props.currentGame)||void 0===n?void 0:n.players[0]:this.props.currentGame.players[1],i=null===(r=this.props.currentGame)||void 0===r?void 0:r.ball;c&&o&&i?(this.drawRectangle(0,0,this.canvas.current.width,this.canvas.current.height,"black"),this.drawText(this.canvas.current.width/5,this.canvas.current.height/8,c.score.toString(),"white"),this.drawText(4*this.canvas.current.width/5,this.canvas.current.height/8,o.score.toString(),"white"),this.drawRectangle(this.canvas.current.width/2-1,0,2,this.canvas.current.height,"white"),this.drawRectangle(c.x,c.y,15,150,"white"),this.drawRectangle(o.x,o.y,15,150,"white"),this.drawCircle(i.x,i.y,i.radius,"white")):console.log("drawGameTable: state elements are null.")}else console.log("drawGameTable: Canvas is null.")}},{key:"drawText",value:function(e,t,a,n){this.gameContext?(this.gameContext.fillStyle=n,this.gameContext.font="50px cursive",this.gameContext.fillText(a,e,t)):console.log("drawText: Context is null.")}},{key:"drawRectangle",value:function(e,t,a,n,r){this.gameContext?(this.gameContext.fillStyle=r,this.gameContext.fillRect(e,t,a,n)):console.log("drawRectangle: Context is null.")}},{key:"drawCircle",value:function(e,t,a,n){this.gameContext?(this.gameContext.fillStyle=n,this.gameContext.beginPath(),this.gameContext.arc(e,t,a,0,2*Math.PI,!1),this.gameContext.closePath(),this.gameContext.fill()):console.log("drawCircle: Context is null.")}}]),a}(n.Component)),N=Object(g.b)((function(e){return{clientId:e.clientId,currentGame:e.currentGame}}),(function(e){return{registerMove:function(t){return e({type:"REGISTER_MOVE",payload:t})}}}))(G),_=(a(56),function(e){Object(l.a)(a,e);var t=Object(u.a)(a);function a(){return Object(i.a)(this,a),t.apply(this,arguments)}return Object(s.a)(a,[{key:"handleStartButton",value:function(){var e;this.props.startGame(null===(e=this.props.currentGame)||void 0===e?void 0:e._id)}},{key:"handleLeaveButton",value:function(){}},{key:"render",value:function(){return this.props.currentGame?this.props.redirect?r.a.createElement(d.a,{to:"/game/".concat(this.props.currentGame._id,"/start")}):r.a.createElement("div",{className:"game-lobby-container"},r.a.createElement("div",{className:"game-lobby-title"},this.props.currentGame.name,":","   ",this.props.currentGame.players.length," out of 2 players"),r.a.createElement("div",{className:"game-lobby-players"},r.a.createElement("div",{className:"player"},this.props.currentGame.players[0]?this.props.currentGame.players[0]._id:""),r.a.createElement("div",{className:"player"},this.props.currentGame.players[1]?this.props.currentGame.players[1]._id:"")),r.a.createElement("div",{className:"game-lobby-actions"},r.a.createElement(m.b,{className:this.props.currentGame.players.length<2?"start-game-disabled":"start-game-enabled",to:"/game/".concat(this.props.currentGame._id,"/start"),onClick:this.handleStartButton.bind(this)},"Start game"),r.a.createElement("button",{onClick:this.handleLeaveButton.bind(this)},"Leave lobby"))):r.a.createElement("div",null,r.a.createElement("div",{className:"not-found-title"},"404 Game Not Found"),r.a.createElement(m.b,{to:"/"},"Return to home page."))}}]),a}(n.Component)),j=Object(g.b)((function(e){return{loading:e.loading,currentGame:e.currentGame,redirect:e.redirectGameTable}}),(function(e){return{startGame:function(t){return e(E(t))}}}))(_),w=function(e){Object(l.a)(a,e);var t=Object(u.a)(a);function a(){return Object(i.a)(this,a),t.apply(this,arguments)}return Object(s.a)(a,[{key:"render",value:function(){return r.a.createElement(d.d,null,r.a.createElement(d.b,{exact:!0,path:"/",component:f}),r.a.createElement(d.b,{exact:!0,path:"/games",component:C}),r.a.createElement(d.b,{exact:!0,path:"/game/:id",component:j}),r.a.createElement(d.b,{exact:!0,path:"/game/:id/start",component:N}))}}]),a}(n.Component),k=function(e){Object(l.a)(a,e);var t=Object(u.a)(a);function a(){return Object(i.a)(this,a),t.apply(this,arguments)}return Object(s.a)(a,[{key:"render",value:function(){return r.a.createElement("div",{className:"app-container"},r.a.createElement(m.a,null,r.a.createElement(w,null)))}}]),a}(n.Component);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));var I=a(36),R=a(20),x=a(14);function T(e){var t=Object(x.a)({},e);return t.loading=!0,t.error="",t}function S(e,t){var a=Object(x.a)({},e);return a.loading=!1,a.error="",a.clientId=t.clientId,a.games=t.games,a}function A(e,t){var a=Object(x.a)({},e);return a.loading=!1,a.error=t.message,a}function M(e){var t=Object(x.a)({},e);return t.loading=!0,t.error="",t}function B(e,t){var a=Object(x.a)({},e);a.loading=!1;var n=a.games.slice();return n.splice(0,0,t.game),a.games=n,a.error="",a}function J(e,t){var a=Object(x.a)({},e);return a.loading=!1,a.error=t.message,a}function P(e){var t=Object(x.a)({},e);return t.loading=!0,t.error="",t}function D(e,t){var a=Object(x.a)({},e);if(a.loading=!1,a.error="",a.currentGame=t.game,2===t.game.players.length)a.games=e.games.filter((function(e){return e._id!==t.game._id}));else{var n=a.games.map((function(e){if(e._id===t.game._id){var a={_id:e._id,name:e.name,players:t.game.players,ball:t.game.ball};e=Object(x.a)({},a)}return e}));a.games=n}return a}function U(e,t){var a=Object(x.a)({},e);return a.loading=!1,a.error=t.message,a}function L(e){var t=Object(x.a)({},e);return t.redirectGameTable=!0,t}function V(e,t){var a=Object(x.a)({},e);return a.currentGame=t.game,a}var Y={clientId:"",games:[],currentGame:void 0,redirectGameTable:!1,loading:!1,error:""},F=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Y,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"CONNECT_PLAYER_BEGIN":return T(e);case"CONNECT_PLAYER_SUCCESS":return S(e,t.payload);case"CONNECT_PLAYER_ERROR":return A(e,t.payload);case"CREATE_GAME_BEGIN":return M(e);case"CREATE_GAME_SUCCESS":return B(e,t.payload);case"CREATE_GAME_ERROR":return J(e,t.payload);case"JOIN_GAME_BEGIN":return P(e);case"JOIN_GAME_SUCCESS":return D(e,t.payload);case"JOIN_GAME_ERROR":return U(e,t.payload);case"START_GAME":return L(e);case"UPDATE_GAME":return V(e,t.payload);default:return e}},K=a(35);var W=a(29),q=a.n(W),$=a(22),z=q.a.mark(H);function H(e){return q.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,Object($.a)("CONNECT_PLAYER_BEGIN",(function(){e.socket.send(JSON.stringify({method:"connect"}))}));case 2:return t.next=4,Object($.a)("CREATE_GAME_BEGIN",(function(t){e.socket.send(JSON.stringify({method:"create",data:t.payload}))}));case 4:return t.next=6,Object($.a)("JOIN_GAME_BEGIN",(function(t){e.socket.send(JSON.stringify({method:"join",data:t.payload}))}));case 6:return t.next=8,Object($.a)("START_GAME",(function(t){e.socket.send(JSON.stringify({method:"start",data:t.payload}))}));case 8:return t.next=10,Object($.a)("REGISTER_MOVE",(function(t){e.socket.send(JSON.stringify({method:"movement",data:t.payload}))}));case 10:case"end":return t.stop()}}),z)}var Q=Object(I.a)();var X=function(){var e=Object(R.createStore)(F,Object(K.composeWithDevTools)(Object(R.applyMiddleware)(Q))),t=function(e){var t=new WebSocket("wss://aqueous-peak-02889.herokuapp.com");return t.onmessage=function(t){var a=JSON.parse(t.data),n=a.method,r=a.data;switch(n){case"connect":console.log("CONNECT RECEIVED: ",a),e(function(e){return{type:"CONNECT_PLAYER_SUCCESS",payload:e}}(r));break;case"create":console.log("CREATE RECEIVED: ",a),e(function(e){return{type:"CREATE_GAME_SUCCESS",payload:e}}(r));break;case"join":console.log("JOIN RECEIVED: ",a),e(function(e){return{type:"JOIN_GAME_SUCCESS",payload:e}}(r));break;case"start":console.log("START RECEIVED: ",a),e(E(r));break;case"update":console.log("UPDATE RECEIVED: ",a);var c=a.data;e(function(e){return{type:"UPDATE_GAME",payload:e}}(c));break;default:console.log("Unknown response.")}},t}(e.dispatch);return Q.run(H,{socket:t}),e}();o.a.render(r.a.createElement(g.a,{store:X},r.a.createElement(k,null)),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))}},[[38,1,2]]]);
//# sourceMappingURL=main.c2e53548.chunk.js.map